<section class="container" style="max-width: 1000px; margin: 0 auto; padding: 2rem;">
  <h1 style="color: #667eea; text-align: center; margin-bottom: 1rem;">⚡ Productos en Tiempo Real</h1>

  <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 1.5rem;">
    <div style="background: #fff; border-radius: 12px; padding: 1rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
      <h3 style="margin-bottom: 0.5rem;">Agregar producto</h3>
      <form id="addForm" onsubmit="return false;">
        <input id="title" placeholder="Título" style="width:100%;margin:.25rem 0;padding:.5rem;border:1px solid #ddd;border-radius:6px;">
        <input id="code" placeholder="Código" style="width:100%;margin:.25rem 0;padding:.5rem;border:1px solid #ddd;border-radius:6px;">
        <input id="price" type="number" placeholder="Precio" style="width:100%;margin:.25rem 0;padding:.5rem;border:1px solid #ddd;border-radius:6px;">
        <input id="stock" type="number" placeholder="Stock" style="width:100%;margin:.25rem 0;padding:.5rem;border:1px solid #ddd;border-radius:6px;">
        <input id="category" placeholder="Categoría" style="width:100%;margin:.25rem 0;padding:.5rem;border:1px solid #ddd;border-radius:6px;">
        <textarea id="description" placeholder="Descripción" style="width:100%;margin:.25rem 0;padding:.5rem;border:1px solid #ddd;border-radius:6px;"></textarea>
        <button onclick="submitAdd()" style="width:100%;background:#48bb78;color:#fff;border:none;padding:.6rem;border-radius:6px;cursor:pointer;">Agregar</button>
      </form>

      <h3 style="margin:1rem 0 .5rem;">Eliminar producto</h3>
      <input id="deleteId" placeholder="ID del producto" style="width:100%;margin:.25rem 0;padding:.5rem;border:1px solid #ddd;border-radius:6px;">
      <button onclick="submitDelete()" style="width:100%;background:#e53e3e;color:#fff;border:none;padding:.6rem;border-radius:6px;cursor:pointer;">Eliminar</button>
    </div>

    <div style="background: #fff; border-radius: 12px; padding: 1rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
      <h3>Listado</h3>
      <div id="list" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:10px;"></div>
    </div>
  </div>
</section>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();

socket.on('products', (items) => {
  const list = document.getElementById('list');
  list.innerHTML = items.map(p => `
    <div style="border:1px solid #eee;border-radius:8px;padding:.75rem;">
      <div style="font-weight:600">${p.title}</div>
      <div style="color:#667eea">$${p.price}</div>
      <div style="font-size:.85rem;color:#666">ID: ${p._id || p.id}</div>
    </div>
  `).join('');
});

socket.on('error', (e) => alert(e.message || 'Error'));

function submitAdd() {
  const prod = {
    title: document.getElementById('title').value,
    code: document.getElementById('code').value,
    price: document.getElementById('price').value,
    stock: document.getElementById('stock').value,
    category: document.getElementById('category').value,
    description: document.getElementById('description').value
  };
  socket.emit('addProduct', prod);
}

function submitDelete() {
  const id = document.getElementById('deleteId').value;
  socket.emit('deleteProduct', id);
}
</script>
